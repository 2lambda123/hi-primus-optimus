from optimus.tests.base import TestBase
import datetime
Timestamp = lambda t: datetime.datetime.strptime(t,"%Y-%m-%d %H:%M:%S")
nan = float("nan")
inf = float("inf")
from optimus.helpers.json import json_encoding
from optimus.helpers.functions import deep_sort

class TestExamplePandas(TestBase):
    config = {'engine': 'pandas'}
    dict = {('name', 'object'): ['Optimus', 'Bumblebee', 'Eject'], ('age (M)', 'int64'): [5, 5, 5]}
    maxDiff = None
    
    def test_cols_upper_multiple(self):
        df = self.df
        result = df.cols.upper(cols=['name', 'age (M)'])
        result = result.to_dict()
        expected = {'name': ['OPTIMUS', 'BUMBLEBEE', 'EJECT'], 'age (M)': ['5', '5', '5']}
        self.assertEqual(json_encoding(result), json_encoding(expected))
    
    def test_cols_upper_single(self):
        df = self.df
        result = df.cols.upper(cols=['name'])
        expected = self.create_dataframe(dict={'name': ['OPTIMUS', 'BUMBLEBEE', 'EJECT'], 'age (M)': [5, 5, 5]})
        self.assertTrue(result.equals(expected))
    
    def test_cols_impute_2(self):
        actual_df = source_df.cols.impute(['rank', 'Cybertronian', 'age'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'float64'): [10.0, 7.0, 7.0, 8.0, 10.0, 8.0], ('Cybertronian', 'float64'): [1.0, 1.0, 1.0, 1.0, 1.0, 0.0], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'float64'): [5000000.0, 5000000.0, 5000000.0, 5000000.0, 5000000.0, 5000000.0], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_clip_1(self):
        actual_df = source_df.cols.clip(['function(binary)', 'Cybertronian'],-34,10)
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'float64'): [NaN, NaN, NaN, NaN, NaN, NaN], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'float64'): [1.0, 1.0, 1.0, 1.0, 1.0, 0.0], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_buffer_window_1(self):
        actual_df = source_df.buffer_window('*',0,3)
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356"], ('rank', 'int64'): [10, 7, 7], ('Cybertronian', 'bool'): [true, true, true], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24"], ('age', 'int64'): [5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_stratified_sample(self):
        actual_df = source_df.stratified_sample('rank',12)
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [91.44, null], [null, 5700.0], [8.5344, 4300.0]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [17.0, 26.0, 13.0, 300.0, NaN, -28.0], ('japanese name', 'object'): [["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Metroflex"], ["Megatron"], ["Inochi", "Convoy"]], ('last date seen', 'datetime64[ns]'): ["2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2011-04-10T00:00:00", "2012-05-10T00:00:00", "2016-09-10T00:00:00"], ('last position seen', 'object'): ["10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null, "19.442735,-99.201111"], ('rank', 'int64'): [7, 7, 8, 8, 10, 10], ('Cybertronian', 'bool'): [true, true, true, false, true, true], ('Date Type', 'object'): ["2015-08-10", "2014-06-24", "2013-06-24", "2011-04-10", "2012-05-10", "2016-09-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Espionage", "Security", "First Lieutenant", "Battle Station", "None", "Leader"], ('names', 'string'): ["bumbl#ebéé  ", "ironhide&", "Jazz", "Metroplex_)^$", "Megatron", "Optimus"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [2.0, 4.0, 1.8, NaN, 5.7, 4.3]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_reverse_3(self):
        actual_df = source_df.cols.reverse('function')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'object'): ["redaeL", "eganoipsE", "ytiruceS", "tnanetueiL tsriF", "enoN", "noitatS elttaB"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_lower_1(self):
        actual_df = source_df.cols.lower(['japanese name', 'function(binary)', 'Cybertronian'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): ["bytearray(b'leader')", "bytearray(b'espionage')", "bytearray(b'security')", "bytearray(b'first lieutenant')", "bytearray(b'none')", "bytearray(b'battle station')"], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): ["['inochi', 'convoy']", "['bumble', 'goldback']", "['roadbuster']", "['meister']", "['megatron']", "['metroflex']"], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'object'): ["true", "true", "true", "true", "true", "false"], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_date_format_2(self):
        actual_df = source_df.cols.date_format('*')
        expected_df = op.create.dataframe(dict={('NullType', 'float64'): [NaN, NaN, NaN, NaN, NaN, NaN], ('attributes', 'float64'): [NaN, NaN, NaN, NaN, NaN, NaN], ('date arrival', 'object'): ["1980-04-10", "1980-04-10", "1980-04-10", "1980-04-10", "1980-04-10", "1980-04-10"], ('function(binary)', 'float64'): [NaN, NaN, NaN, NaN, NaN, NaN], ('height(ft)', 'object'): ["1969-12-31 23:59:59.999999972", "1970-01-01 00:00:00.000000017", "1970-01-01 00:00:00.000000026", "1970-01-01 00:00:00.000000013", NaN, "1970-01-01 00:00:00.000000300"], ('japanese name', 'float64'): [NaN, NaN, NaN, NaN, NaN, NaN], ('last date seen', 'object'): ["2016-09-10", "2015-08-10", "2014-07-10", "2013-06-10", "2012-05-10", "2011-04-10"], ('last position seen', 'object'): [NaN, "1971-10-01", NaN, NaN, NaN, NaN], ('rank', 'object'): ["1970-01-01 00:00:00.000000010", "1970-01-01 00:00:00.000000007", "1970-01-01 00:00:00.000000007", "1970-01-01 00:00:00.000000008", "1970-01-01 00:00:00.000000010", "1970-01-01 00:00:00.000000008"], ('Cybertronian', 'float64'): [NaN, NaN, NaN, NaN, NaN, NaN], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'object'): ["1970-01-01 00:00:00.005", "1970-01-01 00:00:00.005", "1970-01-01 00:00:00.005", "1970-01-01 00:00:00.005", "1970-01-01 00:00:00.005", "1970-01-01 00:00:00.005"], ('function', 'float64'): [NaN, NaN, NaN, NaN, NaN, NaN], ('names', 'float64'): [NaN, NaN, NaN, NaN, NaN, NaN], ('timestamp', 'object'): ["2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24"], ('weight(t)', 'object'): ["1970-01-01 00:00:00.000000004", "1970-01-01 00:00:00.000000002", "1970-01-01 00:00:00.000000004", "1970-01-01 00:00:00.000000001", "1970-01-01 00:00:00.000000005", NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_remove_special_chars_3(self):
        actual_df = source_df.cols.remove_special_chars('names')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'object'): ["Optimus", "bumblebéé  ", "ironhide", "Jazz", "Megatron", "Metroplex"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_qcut_3(self):
        actual_df = source_df.cols.qcut(['rank', 'height(ft)', 'weight(t)'],4)
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'category'): [null, null, null, null, NaN, null], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'category'): [null, null, null, null, null, null], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'category'): [null, null, null, null, null, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_qcut_2(self):
        actual_df = source_df.cols.qcut('last date seen',33)
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'category'): [null, null, null, null, null, null], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_remove_special_chars_2(self):
        actual_df = source_df.cols.remove_special_chars('*')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): ["None", "None", "None", "None", "None", "None"], ('attributes', 'object'): ["85344 43000", "5334 20000", "79248 40000", "39624 18000", "None 57000", "9144 None"], ('date arrival', 'object'): ["19800410", "19800410", "19800410", "19800410", "19800410", "19800410"], ('function(binary)', 'object'): ["bytearraybLeader", "bytearraybEspionage", "bytearraybSecurity", "bytearraybFirst Lieutenant", "bytearraybNone", "bytearraybBattle Station"], ('height(ft)', 'object'): ["280", "170", "260", "130", "nan", "3000"], ('japanese name', 'object'): ["Inochi Convoy", "Bumble Goldback", "Roadbuster", "Meister", "Megatron", "Metroflex"], ('last date seen', 'object'): ["20160910", "20150810", "20140710", "20130610", "20120510", "20110410"], ('last position seen', 'object'): ["1944273599201111", "1064270771612534", "37789563122400356", "33670666117841553", "None", "None"], ('rank', 'object'): ["10", "7", "7", "8", "10", "8"], ('Cybertronian', 'object'): ["True", "True", "True", "True", "True", "False"], ('Date Type', 'object'): ["20160910", "20150810", "20140624", "20130624", "20120510", "20110410"], ('age', 'object'): ["5000000", "5000000", "5000000", "5000000", "5000000", "5000000"], ('function', 'object'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'object'): ["Optimus", "bumblebéé  ", "ironhide", "Jazz", "Megatron", "Metroplex"], ('timestamp', 'object'): ["20140624", "20140624", "20140624", "20140624", "20140624", "20140624"], ('weight(t)', 'object'): ["43", "20", "40", "18", "57", "nan"]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_unique_2(self):
        actual_df = source_df.cols.unique(['Cybertronian', 'age', 'date arrival'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN], ('__duplicated__', 'bool'): [true, false, false, false, false, true]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_remove_1(self):
        actual_df = source_df.cols.remove('function',['a', 'i', 'Es'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'object'): ["Leder", "ponge", "Securty", "Frst Leutennt", "None", "Bttle Stton"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_date_format_3(self):
        actual_df = source_df.cols.date_format('last date seen')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'object'): ["2016-09-10", "2015-08-10", "2014-07-10", "2013-06-10", "2012-05-10", "2011-04-10"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_buffer_window(self):
        actual_df = source_df.buffer_window('*',0,3)
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356"], ('rank', 'int64'): [10, 7, 7], ('Cybertronian', 'bool'): [true, true, true], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24"], ('age', 'int64'): [5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_reverse_2(self):
        actual_df = source_df.cols.reverse('*')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): ["enoN", "enoN", "enoN", "enoN", "enoN", "enoN"], ('attributes', 'object'): ["]0.0034 ,4435.8[", "]0.0002 ,433.5[", "]0.0004 ,8429.7[", "]0.0081 ,4269.3[", "]0.0075 ,enoN[", "]enoN ,44.19["], ('date arrival', 'object'): ["01/40/0891", "01/40/0891", "01/40/0891", "01/40/0891", "01/40/0891", "01/40/0891"], ('function(binary)', 'object'): [")'redaeL'b(yarraetyb", ")'eganoipsE'b(yarraetyb", ")'ytiruceS'b(yarraetyb", ")'tnanetueiL tsriF'b(yarraetyb", ")'enoN'b(yarraetyb", ")'noitatS elttaB'b(yarraetyb"], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): ["]'yovnoC' ,'ihconI'[", "]'kcabdloG' ,'elbmuB'[", "]'retsubdaoR'[", "]'retsieM'[", "]'nortageM'[", "]'xelforteM'["], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["111102.99-,537244.91", "435216.17-,707246.01", "653004.221-,365987.73", "355148.711-,666076.33", "enoN", "enoN"], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["01-90-6102", "01-80-5102", "42-60-4102", "42-60-3102", "01-50-2102", "01-40-1102"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'object'): ["redaeL", "eganoipsE", "ytiruceS", "tnanetueiL tsriF", "enoN", "noitatS elttaB"], ('names', 'object'): ["sumitpO", "  éébe#lbmub", "&edihnori", "zzaJ", "nortageM", "$^)_xelporteM"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_cos(self):
        actual_df = source_df.cols.cos('weight(t)')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [-0.40079917207997545, -0.4161468365471424, -0.6536436208636119, -0.2272020946930871, 0.8347127848391598, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_impute_3(self):
        actual_df = source_df.cols.impute(['rank', 'height(ft)', 'weight(t)'],1)
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, 65.6, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'float64'): [10.0, 7.0, 7.0, 8.0, 10.0, 8.0], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, 3.56]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_remove_white_spaces_4(self):
        actual_df = source_df.cols.remove_white_spaces('age')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'object'): ["5000000", "5000000", "5000000", "5000000", "5000000", "5000000"], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_cos_1(self):
        actual_df = source_df.cols.cos('weight(t)')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [-0.40079917207997545, -0.4161468365471424, -0.6536436208636119, -0.2272020946930871, 0.8347127848391598, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_date_format_4(self):
        actual_df = source_df.cols.date_format('timestamp')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'object'): ["2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_trim_1(self):
        actual_df = source_df.cols.trim(['japanese name', 'function(binary)', 'Cybertronian'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): ["bytearray(b'Leader')", "bytearray(b'Espionage')", "bytearray(b'Security')", "bytearray(b'First Lieutenant')", "bytearray(b'None')", "bytearray(b'Battle Station')"], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): ["['Inochi', 'Convoy']", "['Bumble', 'Goldback']", "['Roadbuster']", "['Meister']", "['Megatron']", "['Metroflex']"], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'object'): ["True", "True", "True", "True", "True", "False"], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_abs_1(self):
        actual_df = source_df.cols.abs('weight(t)')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_remove_white_spaces_3(self):
        actual_df = source_df.cols.remove_white_spaces('names')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'object'): ["Optimus", "bumbl#ebéé", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_impute_4(self):
        actual_df = source_df.cols.impute(['rank', 'height(ft)', 'weight(t)'],4)
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, 65.6, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'float64'): [10.0, 7.0, 7.0, 8.0, 10.0, 8.0], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, 3.56]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_remove_white_spaces_2(self):
        actual_df = source_df.cols.remove_white_spaces('*')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): ["None", "None", "None", "None", "None", "None"], ('attributes', 'object'): ["[8.5344,4300.0]", "[5.334,2000.0]", "[7.9248,4000.0]", "[3.9624,1800.0]", "[None,5700.0]", "[91.44,None]"], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): ["bytearray(b'Leader')", "bytearray(b'Espionage')", "bytearray(b'Security')", "bytearray(b'FirstLieutenant')", "bytearray(b'None')", "bytearray(b'BattleStation')"], ('height(ft)', 'object'): ["-28.0", "17.0", "26.0", "13.0", "nan", "300.0"], ('japanese name', 'object'): ["['Inochi','Convoy']", "['Bumble','Goldback']", "['Roadbuster']", "['Meister']", "['Megatron']", "['Metroflex']"], ('last date seen', 'object'): ["2016-09-10", "2015-08-10", "2014-07-10", "2013-06-10", "2012-05-10", "2011-04-10"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", "None", "None"], ('rank', 'object'): ["10", "7", "7", "8", "10", "8"], ('Cybertronian', 'object'): ["True", "True", "True", "True", "True", "False"], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'object'): ["5000000", "5000000", "5000000", "5000000", "5000000", "5000000"], ('function', 'object'): ["Leader", "Espionage", "Security", "FirstLieutenant", "None", "BattleStation"], ('names', 'object'): ["Optimus", "bumbl#ebéé", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'object'): ["2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24"], ('weight(t)', 'object'): ["4.3", "2.0", "4.0", "1.8", "5.7", "nan"]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_remove(self):
        actual_df = source_df.cols.remove('*',' ')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): ["None", "None", "None", "None", "None", "None"], ('attributes', 'object'): ["[8.5344,4300.0]", "[5.334,2000.0]", "[7.9248,4000.0]", "[3.9624,1800.0]", "[None,5700.0]", "[91.44,None]"], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): ["bytearray(b'Leader')", "bytearray(b'Espionage')", "bytearray(b'Security')", "bytearray(b'FirstLieutenant')", "bytearray(b'None')", "bytearray(b'BattleStation')"], ('height(ft)', 'object'): ["-28.0", "17.0", "26.0", "13.0", "nan", "300.0"], ('japanese name', 'object'): ["['Inochi','Convoy']", "['Bumble','Goldback']", "['Roadbuster']", "['Meister']", "['Megatron']", "['Metroflex']"], ('last date seen', 'object'): ["2016-09-10", "2015-08-10", "2014-07-10", "2013-06-10", "2012-05-10", "2011-04-10"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", "None", "None"], ('rank', 'object'): ["10", "7", "7", "8", "10", "8"], ('Cybertronian', 'object'): ["True", "True", "True", "True", "True", "False"], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'object'): ["5000000", "5000000", "5000000", "5000000", "5000000", "5000000"], ('function', 'object'): ["Leader", "Espionage", "Security", "FirstLieutenant", "None", "BattleStation"], ('names', 'object'): ["Optimus", "bumbl#ebéé", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'object'): ["2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24"], ('weight(t)', 'object'): ["4.3", "2.0", "4.0", "1.8", "5.7", "nan"]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_string_to_index_1(self):
        actual_df = source_df.cols.string_to_index('*')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('NullType_string_to_index', 'int64'): [0, 0, 0, 0, 0, 0], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('attributes_string_to_index', 'int64'): [3, 1, 2, 0, 5, 4], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('date arrival_string_to_index', 'int64'): [0, 0, 0, 0, 0, 0], ('function(binary)', 'object'): [null, null, null, null, null, null], ('function(binary)_string_to_index', 'int64'): [3, 1, 5, 2, 4, 0], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('height(ft)_string_to_index', 'int64'): [0, 2, 3, 1, 5, 4], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('japanese name_string_to_index', 'int64'): [1, 0, 5, 3, 2, 4], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last date seen_string_to_index', 'int64'): [5, 4, 3, 2, 1, 0], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('last position seen_string_to_index', 'int64'): [1, 0, 3, 2, 4, 4], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('rank_string_to_index', 'int64'): [0, 1, 1, 2, 0, 2], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Cybertronian_string_to_index', 'int64'): [1, 1, 1, 1, 1, 0], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('Date Type_string_to_index', 'int64'): [5, 4, 3, 2, 1, 0], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('age_string_to_index', 'int64'): [0, 0, 0, 0, 0, 0], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('function_string_to_index', 'int64'): [3, 1, 5, 2, 4, 0], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('names_string_to_index', 'int64'): [3, 4, 5, 0, 1, 2], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('timestamp_string_to_index', 'int64'): [0, 0, 0, 0, 0, 0], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN], ('weight(t)_string_to_index', 'int64'): [3, 1, 2, 0, 4, 5]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_qcut_4(self):
        actual_df = source_df.cols.qcut(['rank', 'height(ft)', 'weight(t)'],1)
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'category'): [null, null, null, null, NaN, null], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'category'): [null, null, null, null, null, null], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'category'): [null, null, null, null, null, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_remove_special_chars_4(self):
        actual_df = source_df.cols.remove_special_chars('age')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'object'): ["5000000", "5000000", "5000000", "5000000", "5000000", "5000000"], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_upper_1(self):
        actual_df = source_df.cols.upper(['japanese name', 'function(binary)', 'Cybertronian'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): ["BYTEARRAY(B'LEADER')", "BYTEARRAY(B'ESPIONAGE')", "BYTEARRAY(B'SECURITY')", "BYTEARRAY(B'FIRST LIEUTENANT')", "BYTEARRAY(B'NONE')", "BYTEARRAY(B'BATTLE STATION')"], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): ["['INOCHI', 'CONVOY']", "['BUMBLE', 'GOLDBACK']", "['ROADBUSTER']", "['MEISTER']", "['MEGATRON']", "['METROFLEX']"], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'object'): ["TRUE", "TRUE", "TRUE", "TRUE", "TRUE", "FALSE"], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_z_score_1(self):
        actual_df = source_df.cols.z_score('weight(t)')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [1.8835372346442196, -0.4164627653557802, 1.5835372346442198, -0.6164627653557802, 3.28353723464422, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_trim_3(self):
        actual_df = source_df.cols.trim('function')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'object'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_upper_2(self):
        actual_df = source_df.cols.upper('*')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): ["NONE", "NONE", "NONE", "NONE", "NONE", "NONE"], ('attributes', 'object'): ["[8.5344, 4300.0]", "[5.334, 2000.0]", "[7.9248, 4000.0]", "[3.9624, 1800.0]", "[NONE, 5700.0]", "[91.44, NONE]"], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): ["BYTEARRAY(B'LEADER')", "BYTEARRAY(B'ESPIONAGE')", "BYTEARRAY(B'SECURITY')", "BYTEARRAY(B'FIRST LIEUTENANT')", "BYTEARRAY(B'NONE')", "BYTEARRAY(B'BATTLE STATION')"], ('height(ft)', 'object'): ["-28.0", "17.0", "26.0", "13.0", "NAN", "300.0"], ('japanese name', 'object'): ["['INOCHI', 'CONVOY']", "['BUMBLE', 'GOLDBACK']", "['ROADBUSTER']", "['MEISTER']", "['MEGATRON']", "['METROFLEX']"], ('last date seen', 'object'): ["2016-09-10", "2015-08-10", "2014-07-10", "2013-06-10", "2012-05-10", "2011-04-10"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", "NONE", "NONE"], ('rank', 'object'): ["10", "7", "7", "8", "10", "8"], ('Cybertronian', 'object'): ["TRUE", "TRUE", "TRUE", "TRUE", "TRUE", "FALSE"], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'object'): ["5000000", "5000000", "5000000", "5000000", "5000000", "5000000"], ('function', 'object'): ["LEADER", "ESPIONAGE", "SECURITY", "FIRST LIEUTENANT", "NONE", "BATTLE STATION"], ('names', 'object'): ["OPTIMUS", "BUMBL#EBÉÉ  ", "IRONHIDE&", "JAZZ", "MEGATRON", "METROPLEX_)^$"], ('timestamp', 'object'): ["2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24"], ('weight(t)', 'object'): ["4.3", "2.0", "4.0", "1.8", "5.7", "NAN"]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_z_score_2(self):
        actual_df = source_df.cols.z_score(['names', 'height(ft)'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.552839175542417, 16.447160824457583, 25.447160824457583, 12.447160824457582, NaN, 299.44716082445757], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'float64'): [NaN, NaN, NaN, NaN, NaN, NaN], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_remove_white_spaces_1(self):
        actual_df = source_df.cols.remove_white_spaces(['japanese name', 'function(binary)', 'Cybertronian'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): ["bytearray(b'Leader')", "bytearray(b'Espionage')", "bytearray(b'Security')", "bytearray(b'FirstLieutenant')", "bytearray(b'None')", "bytearray(b'BattleStation')"], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): ["['Inochi','Convoy']", "['Bumble','Goldback']", "['Roadbuster']", "['Meister']", "['Megatron']", "['Metroflex']"], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'object'): ["True", "True", "True", "True", "True", "False"], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_string_to_index_2(self):
        actual_df = source_df.cols.string_to_index(['names', 'function'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('function_string_to_index', 'int64'): [3, 1, 5, 2, 4, 0], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('names_string_to_index', 'int64'): [3, 4, 5, 0, 1, 2], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_abs_2(self):
        actual_df = source_df.cols.abs(['function', 'rank', 'height(ft)'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'float64'): [10.0, 7.0, 7.0, 8.0, 10.0, 8.0], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'float64'): [NaN, NaN, NaN, NaN, NaN, NaN], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_clip_4(self):
        actual_df = source_df.cols.clip('date arrival',3447,123)
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'float64'): [NaN, NaN, NaN, NaN, NaN, NaN], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_lower_4(self):
        actual_df = source_df.cols.lower('age')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'object'): ["5000000", "5000000", "5000000", "5000000", "5000000", "5000000"], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_upper_3(self):
        actual_df = source_df.cols.upper('function')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'object'): ["LEADER", "ESPIONAGE", "SECURITY", "FIRST LIEUTENANT", "NONE", "BATTLE STATION"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_trim_2(self):
        actual_df = source_df.cols.trim('*')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): ["None", "None", "None", "None", "None", "None"], ('attributes', 'object'): ["[8.5344, 4300.0]", "[5.334, 2000.0]", "[7.9248, 4000.0]", "[3.9624, 1800.0]", "[None, 5700.0]", "[91.44, None]"], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): ["bytearray(b'Leader')", "bytearray(b'Espionage')", "bytearray(b'Security')", "bytearray(b'First Lieutenant')", "bytearray(b'None')", "bytearray(b'Battle Station')"], ('height(ft)', 'object'): ["-28.0", "17.0", "26.0", "13.0", "nan", "300.0"], ('japanese name', 'object'): ["['Inochi', 'Convoy']", "['Bumble', 'Goldback']", "['Roadbuster']", "['Meister']", "['Megatron']", "['Metroflex']"], ('last date seen', 'object'): ["2016-09-10", "2015-08-10", "2014-07-10", "2013-06-10", "2012-05-10", "2011-04-10"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", "None", "None"], ('rank', 'object'): ["10", "7", "7", "8", "10", "8"], ('Cybertronian', 'object'): ["True", "True", "True", "True", "True", "False"], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'object'): ["5000000", "5000000", "5000000", "5000000", "5000000", "5000000"], ('function', 'object'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'object'): ["Optimus", "bumbl#ebéé", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'object'): ["2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24"], ('weight(t)', 'object'): ["4.3", "2.0", "4.0", "1.8", "5.7", "nan"]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_buffer_window_3(self):
        actual_df = source_df.buffer_window('last position seen',4,5)
        expected_df = op.create.dataframe(dict={('last position seen', 'object'): [null]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_clip_3(self):
        actual_df = source_df.cols.clip('age',0,0)
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'float64'): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_cos_2(self):
        actual_df = source_df.cols.cos('age')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'float64'): [-0.21532488687824777, -0.21532488687824777, -0.21532488687824777, -0.21532488687824777, -0.21532488687824777, -0.21532488687824777], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_string_to_index(self):
        actual_df = source_df.cols.string_to_index('age')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('age_string_to_index', 'int64'): [0, 0, 0, 0, 0, 0], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_qcut_1(self):
        actual_df = source_df.cols.qcut('last date seen',87)
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'category'): [null, null, null, null, null, null], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_unique_1(self):
        actual_df = source_df.cols.unique('rank')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'bool'): [true, true, false, true, false, false], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_remove_special_chars_1(self):
        actual_df = source_df.cols.remove_special_chars(['japanese name', 'function(binary)', 'Cybertronian'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): ["bytearraybLeader", "bytearraybEspionage", "bytearraybSecurity", "bytearraybFirst Lieutenant", "bytearraybNone", "bytearraybBattle Station"], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): ["Inochi Convoy", "Bumble Goldback", "Roadbuster", "Meister", "Megatron", "Metroflex"], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'object'): ["True", "True", "True", "True", "True", "False"], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_remove_2(self):
        actual_df = source_df.cols.remove('*',['s', 'zz'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): ["None", "None", "None", "None", "None", "None"], ('attributes', 'object'): ["[8.5344, 4300.0]", "[5.334, 2000.0]", "[7.9248, 4000.0]", "[3.9624, 1800.0]", "[None, 5700.0]", "[91.44, None]"], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): ["bytearray(b'Leader')", "bytearray(b'Epionage')", "bytearray(b'Security')", "bytearray(b'Firt Lieutenant')", "bytearray(b'None')", "bytearray(b'Battle Station')"], ('height(ft)', 'object'): ["-28.0", "17.0", "26.0", "13.0", "nan", "300.0"], ('japanese name', 'object'): ["['Inochi', 'Convoy']", "['Bumble', 'Goldback']", "['Roadbuter']", "['Meiter']", "['Megatron']", "['Metroflex']"], ('last date seen', 'object'): ["2016-09-10", "2015-08-10", "2014-07-10", "2013-06-10", "2012-05-10", "2011-04-10"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", "None", "None"], ('rank', 'object'): ["10", "7", "7", "8", "10", "8"], ('Cybertronian', 'object'): ["True", "True", "True", "True", "True", "Fale"], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'object'): ["5000000", "5000000", "5000000", "5000000", "5000000", "5000000"], ('function', 'object'): ["Leader", "Epionage", "Security", "Firt Lieutenant", "None", "Battle Station"], ('names', 'object'): ["Optimu", "bumbl#ebéé  ", "ironhide&", "Ja", "Megatron", "Metroplex_)^$"], ('timestamp', 'object'): ["2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24"], ('weight(t)', 'object'): ["4.3", "2.0", "4.0", "1.8", "5.7", "nan"]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_upper_4(self):
        actual_df = source_df.cols.upper('age')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'object'): ["5000000", "5000000", "5000000", "5000000", "5000000", "5000000"], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_lower_3(self):
        actual_df = source_df.cols.lower('function')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'object'): ["leader", "espionage", "security", "first lieutenant", "none", "battle station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_reverse_1(self):
        actual_df = source_df.cols.reverse(['japanese name', 'function(binary)', 'Cybertronian'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [")'redaeL'b(yarraetyb", ")'eganoipsE'b(yarraetyb", ")'ytiruceS'b(yarraetyb", ")'tnanetueiL tsriF'b(yarraetyb", ")'enoN'b(yarraetyb", ")'noitatS elttaB'b(yarraetyb"], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): ["]'yovnoC' ,'ihconI'[", "]'kcabdloG' ,'elbmuB'[", "]'retsubdaoR'[", "]'retsieM'[", "]'nortageM'[", "]'xelforteM'["], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_lower_2(self):
        actual_df = source_df.cols.lower('*')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): ["none", "none", "none", "none", "none", "none"], ('attributes', 'object'): ["[8.5344, 4300.0]", "[5.334, 2000.0]", "[7.9248, 4000.0]", "[3.9624, 1800.0]", "[none, 5700.0]", "[91.44, none]"], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): ["bytearray(b'leader')", "bytearray(b'espionage')", "bytearray(b'security')", "bytearray(b'first lieutenant')", "bytearray(b'none')", "bytearray(b'battle station')"], ('height(ft)', 'object'): ["-28.0", "17.0", "26.0", "13.0", "nan", "300.0"], ('japanese name', 'object'): ["['inochi', 'convoy']", "['bumble', 'goldback']", "['roadbuster']", "['meister']", "['megatron']", "['metroflex']"], ('last date seen', 'object'): ["2016-09-10", "2015-08-10", "2014-07-10", "2013-06-10", "2012-05-10", "2011-04-10"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", "none", "none"], ('rank', 'object'): ["10", "7", "7", "8", "10", "8"], ('Cybertronian', 'object'): ["true", "true", "true", "true", "true", "false"], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'object'): ["5000000", "5000000", "5000000", "5000000", "5000000", "5000000"], ('function', 'object'): ["leader", "espionage", "security", "first lieutenant", "none", "battle station"], ('names', 'object'): ["optimus", "bumbl#ebéé  ", "ironhide&", "jazz", "megatron", "metroplex_)^$"], ('timestamp', 'object'): ["2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24"], ('weight(t)', 'object'): ["4.3", "2.0", "4.0", "1.8", "5.7", "nan"]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_date_format_1(self):
        actual_df = source_df.cols.date_format(['japanese name', 'function(binary)', 'Cybertronian'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'float64'): [NaN, NaN, NaN, NaN, NaN, NaN], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'float64'): [NaN, NaN, NaN, NaN, NaN, NaN], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'float64'): [NaN, NaN, NaN, NaN, NaN, NaN], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_remove_3(self):
        actual_df = source_df.cols.remove('*',' ')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): ["None", "None", "None", "None", "None", "None"], ('attributes', 'object'): ["[8.5344,4300.0]", "[5.334,2000.0]", "[7.9248,4000.0]", "[3.9624,1800.0]", "[None,5700.0]", "[91.44,None]"], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): ["bytearray(b'Leader')", "bytearray(b'Espionage')", "bytearray(b'Security')", "bytearray(b'FirstLieutenant')", "bytearray(b'None')", "bytearray(b'BattleStation')"], ('height(ft)', 'object'): ["-28.0", "17.0", "26.0", "13.0", "nan", "300.0"], ('japanese name', 'object'): ["['Inochi','Convoy']", "['Bumble','Goldback']", "['Roadbuster']", "['Meister']", "['Megatron']", "['Metroflex']"], ('last date seen', 'object'): ["2016-09-10", "2015-08-10", "2014-07-10", "2013-06-10", "2012-05-10", "2011-04-10"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", "None", "None"], ('rank', 'object'): ["10", "7", "7", "8", "10", "8"], ('Cybertronian', 'object'): ["True", "True", "True", "True", "True", "False"], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'object'): ["5000000", "5000000", "5000000", "5000000", "5000000", "5000000"], ('function', 'object'): ["Leader", "Espionage", "Security", "FirstLieutenant", "None", "BattleStation"], ('names', 'object'): ["Optimus", "bumbl#ebéé", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'object'): ["2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24"], ('weight(t)', 'object'): ["4.3", "2.0", "4.0", "1.8", "5.7", "nan"]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_trim_4(self):
        actual_df = source_df.cols.trim('age')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'object'): ["5000000", "5000000", "5000000", "5000000", "5000000", "5000000"], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_remove_list(self):
        actual_df = source_df.cols.remove('*',['a', 'i', 'Es'])
        expected_df = op.create.dataframe(dict={('NullType', 'object'): ["None", "None", "None", "None", "None", "None"], ('attributes', 'object'): ["[8.5344, 4300.0]", "[5.334, 2000.0]", "[7.9248, 4000.0]", "[3.9624, 1800.0]", "[None, 5700.0]", "[91.44, None]"], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): ["byterry(b'Leder')", "byterry(b'ponge')", "byterry(b'Securty')", "byterry(b'Frst Leutennt')", "byterry(b'None')", "byterry(b'Bttle Stton')"], ('height(ft)', 'object'): ["-28.0", "17.0", "26.0", "13.0", "nn", "300.0"], ('japanese name', 'object'): ["['Inoch', 'Convoy']", "['Bumble', 'Goldbck']", "['Rodbuster']", "['Mester']", "['Megtron']", "['Metroflex']"], ('last date seen', 'object'): ["2016-09-10", "2015-08-10", "2014-07-10", "2013-06-10", "2012-05-10", "2011-04-10"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", "None", "None"], ('rank', 'object'): ["10", "7", "7", "8", "10", "8"], ('Cybertronian', 'object'): ["True", "True", "True", "True", "True", "Flse"], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'object'): ["5000000", "5000000", "5000000", "5000000", "5000000", "5000000"], ('function', 'object'): ["Leder", "ponge", "Securty", "Frst Leutennt", "None", "Bttle Stton"], ('names', 'object'): ["Optmus", "bumbl#ebéé  ", "ronhde&", "Jzz", "Megtron", "Metroplex_)^$"], ('timestamp', 'object'): ["2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24", "2014-06-24"], ('weight(t)', 'object'): ["4.3", "2.0", "4.0", "1.8", "5.7", "nn"]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_impute_1(self):
        actual_df = source_df.cols.impute('height(ft)')
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, 65.6, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))
    
    def test_cols_clip_2(self):
        actual_df = source_df.cols.clip('rank',0.1,0.2)
        expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'float64'): [0.2, 0.2, 0.2, 0.2, 0.2, 0.2], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int64'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
        self.assertTrue(expected_df.equals(actual_df))

class TestExampleDask(TestExamplePandas):
    config = {'engine': 'dask', 'n_partitions': 1}

class TestExampleDask2(TestExamplePandas):
    config = {'engine': 'dask', 'n_partitions': 2}
