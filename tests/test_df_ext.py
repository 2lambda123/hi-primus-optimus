import numpy as np
NaN = np.nan
null = None
false = False
true = True
from optimus import Optimus
from optimus.helpers.json import json_enconding
from optimus.helpers.functions import deep_sort
import unittest
import datetime
op = Optimus("pandas")
source_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [5.334, 2000.0], [7.9248, 4000.0], [3.9624, 1800.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 17.0, 26.0, 13.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Bumble", "Goldback"], ["Roadbuster"], ["Meister"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2015-08-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "10.642707,-71.612534", "37.789563,-122.400356", "33.670666,-117.841553", null, null], ('rank', 'int64'): [10, 7, 7, 8, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2015-08-10", "2014-06-24", "2013-06-24", "2012-05-10", "2011-04-10"], ('age', 'int32'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Espionage", "Security", "First Lieutenant", "None", "Battle Station"], ('names', 'string'): ["Optimus", "bumbl#ebéé  ", "ironhide&", "Jazz", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 2.0, 4.0, 1.8, 5.7, NaN]}, n_partitions=1)
class Test_df_ext(unittest.TestCase):
	maxDiff = None
	@staticmethod
	def test_sample():
		actual_df =source_df.sample(5,True)
		expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[8.5344, 4300.0], [7.9248, 4000.0], [3.9624, 1800.0], [5.334, 2000.0], [null, 5700.0], [91.44, null]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [-28.0, 26.0, 13.0, 17.0, NaN, 300.0], ('japanese name', 'object'): [["Inochi", "Convoy"], ["Roadbuster"], ["Meister"], ["Bumble", "Goldback"], ["Megatron"], ["Metroflex"]], ('last date seen', 'datetime64[ns]'): ["2016-09-10T00:00:00", "2014-07-10T00:00:00", "2013-06-10T00:00:00", "2015-08-10T00:00:00", "2012-05-10T00:00:00", "2011-04-10T00:00:00"], ('last position seen', 'object'): ["19.442735,-99.201111", "37.789563,-122.400356", "33.670666,-117.841553", "10.642707,-71.612534", null, null], ('rank', 'int64'): [10, 7, 8, 7, 10, 8], ('Cybertronian', 'bool'): [true, true, true, true, true, false], ('Date Type', 'object'): ["2016-09-10", "2014-06-24", "2013-06-24", "2015-08-10", "2012-05-10", "2011-04-10"], ('age', 'int32'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Leader", "Security", "First Lieutenant", "Espionage", "None", "Battle Station"], ('names', 'string'): ["Optimus", "ironhide&", "Jazz", "bumbl#ebéé  ", "Megatron", "Metroplex_)^$"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.3, 4.0, 1.8, 2.0, 5.7, NaN]}, n_partitions=1)
		assert (expected_df.equals(actual_df))
	@staticmethod
	def test_stratified_sample():
		actual_df =source_df.stratified_sample('rank',12)
		expected_df = op.create.dataframe(dict={('NullType', 'object'): [null, null, null, null, null, null], ('attributes', 'object'): [[7.9248, 4000.0], [5.334, 2000.0], [91.44, null], [3.9624, 1800.0], [8.5344, 4300.0], [null, 5700.0]], ('date arrival', 'object'): ["1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10", "1980/04/10"], ('function(binary)', 'object'): [null, null, null, null, null, null], ('height(ft)', 'float64'): [26.0, 17.0, 300.0, 13.0, -28.0, NaN], ('japanese name', 'object'): [["Roadbuster"], ["Bumble", "Goldback"], ["Metroflex"], ["Meister"], ["Inochi", "Convoy"], ["Megatron"]], ('last date seen', 'datetime64[ns]'): ["2014-07-10T00:00:00", "2015-08-10T00:00:00", "2011-04-10T00:00:00", "2013-06-10T00:00:00", "2016-09-10T00:00:00", "2012-05-10T00:00:00"], ('last position seen', 'object'): ["37.789563,-122.400356", "10.642707,-71.612534", null, "33.670666,-117.841553", "19.442735,-99.201111", null], ('rank', 'int64'): [7, 7, 8, 8, 10, 10], ('Cybertronian', 'bool'): [true, true, false, true, true, true], ('Date Type', 'object'): ["2014-06-24", "2015-08-10", "2011-04-10", "2013-06-24", "2016-09-10", "2012-05-10"], ('age', 'int32'): [5000000, 5000000, 5000000, 5000000, 5000000, 5000000], ('function', 'string'): ["Security", "Espionage", "Battle Station", "First Lieutenant", "Leader", "None"], ('names', 'string'): ["ironhide&", "bumbl#ebéé  ", "Metroplex_)^$", "Jazz", "Optimus", "Megatron"], ('timestamp', 'datetime64[ns]'): ["2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00", "2014-06-24T00:00:00"], ('weight(t)', 'float64'): [4.0, 2.0, NaN, 1.8, 4.3, 5.7]}, n_partitions=1)
		assert (expected_df.equals(actual_df))
